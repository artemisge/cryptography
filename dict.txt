Εισαγωγή
στο
μάθημα
της
κρυπτογραφίας
Μάθημα
1ο
Κ.Α.
Δραζιώτης
1
Λίγα
λόγια
για
το
μάθημα
Στόχοι
του
μαθήματος.
1.
Να
κατανοήσω
βασικά
κρυπτοσυστήματα
συμμετρικά
και
δημοσιού
κλειδιού
που
έχουν
εφαρμογή
στα
σύγχρονα
κρυπτογραφικά
πρωτόκολλα
στο
διαδίκτυο.
2.
Να
μάθω
το
απαραίτητο
μαθηματικό
υπόβαθρο
που
απαιτείται
για
την
κατονόηση
του
rsa
και
diffie-hellman
3.
Να
μάθω
βασικά
πράγματα
για
το
πρωτόκολλο
ssl/tls
4.
Να
μαθώ
να
υλοποιώ
απλές
επιθέσεις
με
χρήση
python/c/
c++
στο
rsa
5.
Να
μάθω
βασικές
αρχές
για
pen
test!
(extra
bonus)
Μάθημα
1ο
Κ.Α.Δραζιώτης
2
Λίγα
λόγια
για
το
μάθημα
eργασία
(project)
(40%)
Παρουσίαση
ενός
θέματος
κρυπτογραφίας
(bonus)
(10%)
Στο
τέλος
γραπτές
ή
προφορικές
εξετάσεις
(60%)
Μάθημα
1ο
Κ.Α.Δραζιώτης
3
Προαπαιτούμενα
Εγκαταστήστε
την
python
(
διανομή
anaconda
+
jupyter
)
eγκαταστήστε
μια
διανομή
του
linux!
Μάθημα
1ο
Κ.Α.Δραζιώτης
4
Ελληνική
Βιβλιογραφία
Βιβλία
1.
Υπολογιστική
Κρυπτογραφία
(Κάλιππος)
2.
Δίκτυα
και
ασφάλεια,
stalling
(Εύδοξος)
Για
τον
ελεύθερο
χρόνο
σας
Κώδικες
και
μυστικά,
s.singh
(καλό
εισαγωγικό
βιβλίο
και
αρκετά
διασκεδαστικό)
elearning
Μάθημα
1ο
Κ.Α.Δραζιώτης
5
Που
χρειάζεται
η
κρυπτογραφία;
h
κρυπτογραφία
χρησιμοποιείται
για
να
προστατεύει
πληροφορίες
σ’ένα
υπολογιστικό
σύστημα.
Για
παράδειγμα
στις
on-line
συναλλαγές
μας
με
μια
τράπεζα
και
στην
προστασία
των
κωδικών
μας,
τρέχουν
πολλοί
κρυπτογραφικοί
αλγόριθμοι.
Για
την
προστασία
στρατιωτικών
μυστικών,ιατρικών
δεδομένων,
βιομηχανικών
μυστικών
κ.λπ.
Μάθημα
1ο
Κ.Α.Δραζιώτης
6
Η
κρυπτογραφία
όσο
χρήσιμη
είναι,
τόσο
δύσκολο
είναι
να
υλοποιηθεί
σωστά
(η
sony
αποτελεί
μια
τέτοια
περίπτωση
που
χρησιμοποίησε
με
λανθασμένο
τρόπο
κρυπτογραφικό
σύστημα
για
να
προστατέψει
από
την
πειρατεία
λογισμικό
για
την
κονσόλα
ps3)
Σε
αυτό
το
μάθημα
θα
δώσουμε
έμφαση
σε
σύγχρονες
εφαρμογές
της
κρυπτογραφίας.
Η
κρυπτογραφία
δεν
είναι
:
1.
η
λύση
για
όλα
τα
θέματα
ασφαλείας
2.
χρήσιμη
αν
δεν
υλοποιηθεί
σωστά
Μάθημα
1ο
Κ.Α.Δραζιώτης
7
Η
κρυπτογραφία
χρησιμοποιείται
πολύ
συχνά
web
traffic
:
https
(ssl/tls)
Ασύρματα
δίκτυα
:
802.11i
wpa
2
Προστασία
δεδομένων
:
(dvd)
css
Προστασία
από
την
πειρατεία
:
Παιχνίδια
Ηλεκτρονική
Ψηφοφορία
Ανωνυμία
στο
διαδίκτυο
:
tor,
tails
(onion
protocol)
Ψηφιακή
υπογραφή
kρυπτογράφηση
e-mail
(pgp)
bitcoin
Μάθημα
1ο
Κ.Α.Δραζιώτης
8
Συμμετρική
Κρυπτογραφία
Την
χρησιμοποιούμε
για
να
κρυπτογραφήσουμε
ένα
μήνυμα.
alice
m
(μήνυμα)
e
bob
e(k,m)=c
Μη
ασφαλής
δίαυλος
k
(key)
d
k
(key)
sos
:
o
αλγόριθμος
κρυπτογράφησης
e
και
αποκρυπτογράφησης
d
είναι
δημόσια
γνωστοί.
Αρχή
του
kerckhoff
:
h
ασφάλεια
ενός
κρυπτοσυστήματος
δεν
πρέπει
να
βασίζεται
στη
γνώση
του
κρυπτοσυστήματος,
αλλά
στη
γνώση
του
μυστικού
κλειδιού
9
d(k,c)=m
Συμμετρική
Κρυπτογραφία
Ονομάζεται
συμμετρική
κρυπτογραφία
διότι,
τόσο
η
alice
όσο
και
ο
bob
χρησιμοποιούν
το
ίδιο
κλειδί
κρυπτογράφησης
και
αποκρυπτογράφησης.
Υπάρχουν
συστήματα
στα
οποία
αυτά
τα
δύο
κλειδιά
είναι
διαφορετικά
(π.χ.
στο
rsa).
Γι’αυτό
και
ονομάζονται
ασύμμετρα
συστήματα
κρυπτογράφησης.
Μερικοι
αξιόπιστοι
συμμετρικοί
αλγόριθμοι
είναι:
aes
(rijndael),chacha20,twofish,
serpent,blowfish,cast5,idea
Εμείς
θα
δούμε
ένα
από
τα
πρώτα
συμμετρικά
συστήματα
που
υιοθέτησε
η
nsa
,που
είναι
τo
des
(data
encryption
standard).
eπίσης
θα
δούμε
και
το
σύγχρονο
σύστημα
aes.
Μάθημα
1ο
Κ.Α.Δραζιώτης
10
Ανακεφαλαίωση.
Τι
είναι
η
κρυπτογραφία;
o
“πυρήνας”
ενός
συστήματος
κρυπτογραφίας
αποτελείται
από
δύο
μέρη
1.
Παραγωγή
κοινού
μυστικού
κλειδιού
2.
Ασφαλή
μετάδοση
μηνύματος
Μάθημα
1ο
Κ.Α.Δραζιώτης
11
Η
κρυπτογραφία
μπορεί
να
κάνει
και
περισσότερα…
Με
την
κατάλληλη
χρήση
των
κρυπτογραφικών
αλγορίθμων
μπορώ:
1.
να
φτιάξω
ψηφιακές
υπογραφές.
2.
https
3.
να
κάνω
ανώνυμη
περιήγηση
(mix
net,
tor).
4.
ssh
(secure
shell)
5.
να
έχω
ανώνυμο
ψηφιακό
χρήμα
(bitcoin).
6.
να
ψηφίζω
ηλεκτρονικά.
7.
να
κάνω
αποδείξεις
μηδενικής
γνώσης
(zero-knowledge
proofs)
8.
post
quantum
κρυπτογραφικά
συστήματα
9.
Ομομορφική
κρυπτογράφηση
10.
lightweight
cryptography
Μάθημα
1ο
Κ.Α.Δραζιώτης
12
Ψηφιακή
υπογραφή
Πολλές
φορές
χρειάζεται
να
υπογράψουμε
ηλεκτρονικά
ένα
έγγραφο.
Για
παράδειγμα
η
αναφορά
που
συντάσσει
ένας
αστυνόμος
πρέπει
να
υπογραφεί
με
τέτοιο
τρόπο
ώστε
να
βεβαιώνεται
η
ταυτότητα
του.
Σήμερα
και
στην
Ελλάδα
οι
ψηφιακές
υπογραφές
έχουν
νομική
ισχύ,
μέσα
από
μια
σειρά
νόμων.
Η
ΑΠΕΔ
είναι
η
αρχή
πιστοποίησης
του
ελληνικού
δημοσίου.
Οι
υπηρεσίες
οι
οποίες
προσφέρονται
από
την
εν
λόγω
υποδομή,
δίνουν
τη
δυνατότητα
στα
στελέχη
του
Δημοσίου
και
τους
πολίτες,
με
τη
χρήση
Ασφαλών
Διατάξεων
Δημιουργίας
Υπογραφής
(ΑΔΔΥ
-
etoken),
να
υπογράφουν
ψηφιακά
τις
μεταξύ
τους
ηλεκτρονικές
επικοινωνίες
και
συναλλαγές.
Η
ψηφιακή
αυτή
υπογραφή,
σύμφωνα
με
το
Π.Δ.
150/2001
(ΦΕΚ
125/Α΄/2001),
επέχει
θέση
ιδιόχειρης
υπογραφής
τόσο
στο
ουσιαστικό
όσο
και
στο
δικονομικό
δίκαιο.
Μάθημα
1ο
Κ.Α.Δραζιώτης
13
Μερικές
μόνο
αρχές
πιστοποίησης
μπορούν
να
εκδίδουν
εγκεκριμένες
(qualified)
ψηφ.
Υπογραφές.
oι
εγκεκριμένες
ψηφ.
Υπογραφές
έχουν
την
ισχύ
της
ιδιόχειρης
υπογραφής.
Φυσικά
η
aΠΕΔ,
αλλά
και
το
Α.Π.Θ.
(διά
της
harica
:
υποδομή
δημοσίου
κλειδιού
των
ακδημαικων
ιδρυμάτων)
καθώς
και
η
εταιρεία
adacom.
Π.χ.
η
ΑΠΕΔ
εκδίδει
δωρεάν
ψηφιακές
υπογραφές
με
κατάλληλη
αίτηση
(σε
όλους
τους
έλληνες
πολίτες)
στην
ψηφιακή
πύλη
ermis.
eπίσης
το
ΑΠΘ
εκδίδει
δωρεαν
ψηφ.
υπογραφές
στους
υπαλλήλους
της
καθώς
και
τους
φοιτητές.
Μάθημα
1ο
Κ.Α.Δραζιώτης
14
Ασφαλής
επικοινωνία
ssl/tls
Για
παράδειγμα
η
alice
προσπαθεί
να
επικοινωνήσει
με
ασφάλεια
με
τον
bob.
Αν
η
Έυα
παρακολουθεί
τη
συνομιλία
τους,
το
κρυπτογραφικό
πρωτόκολλο
https
εγγυάται
ότι
δεν
μπορεί
η
συνομιλία
της
alice
και
του
Βοb
να
κλαπεί
(εμπιστευτικότητα)
και
επίσης
δεν
μπορεί
η
Έυα
να
παρέμβει
και
να
αλλάξει
την
συνομιλία
μας
(ακεραιότητα).
Οι
Κρυπταναλυτές
έχουν
τον
ρόλο
της
Έυας.
Μάθημα
1ο
Κ.Α.Δραζιώτης
15
Το
πρωτόκολλο
ssl/tls
υλοποιείται
σε
δύο
βήματα.
1.
Χειραψία
(handshake).
Η
χειραψία
είναι
ένας
αλγόριθμος
που
στο
τέλος
θα
έχει
δώσει
ένα
κοινό
κλειδί
στον
bob
και
την
alice
και
η
Έυα
παρότι
θα
παρακολουθεί
το
κανάλι
δεν
θα
μπορεί
να
“έχει”
αυτό
το
κλειδί.
Το
κλειδί
παράγεται
με
χρήση
της
κρυπτογραφίας
δημόσιου
κλειδιού
(public
key
cryptography)
2.
record
layer.
Σε
αυτό
το
βήμα
η
alice
και
ο
Βοb
ανταλλάσσουν
μηνύματα
κάνοντας
χρήση
του
κοινού
μυστικού
κλειδιού.
Στο
βήμα
αυτό
διασφαλίζεται
η
εμπιστευτικότητα
και
η
ακεραιότητα.
Για
να
υλοποιηθεί
αυτό
το
βήμα
χρησιμοποιώ
συμμετρική
κρυπτογραφία
για
την
εμπιστευτικότητα
και
συμμετρική
κρυπτογραφία
για
την
ακεραιότητα.
Μάθημα
1ο
Κ.Α.Δραζιώτης
16
Ανώνυμη
περιήγηση
Τα
συστήματα
αυτά,
χρησιμοποιούν
μία
αλυσίδα
από
proxy
servers
και
κάθε
μήνυμα
κρυπτογραφείται
καθώς
μετακινείται
από
τον
έναν
proxy
στον
άλλον.
Το
αποτέλεσμα
είναι
ο
παραλήπτης
να
μην
γνωρίζει
τον
αποστολέα.
Μάθημα
1ο
Κ.Α.Δραζιώτης
17
to
tor
project
κάνοντας
χρήση
του
«onion
routing»
πετυχαίνει
την
ανώνημη
περιήγηση.
encrypted
alice
3rd
tor
relay
1st
tor
relay
2nd
tor
relay
bob
not
encrypted
Μάθημα
1ο
Κ.Α.Δραζιώτης
18
Ανώνυμη
περιήγηση




o
τελευταίος
Τοr
server
μπορεί
να
δει
τα
δεδομένα
που
έχουμε
στείλει,
αλλά
δεν
ξέρει
ποιος
τα
έστειλε.
o
bob
βλέπει
τα
δεδομένα
που
έστειλε
η
alice
αλλά
δεν
γνωρίζει
ότι
τα
έστειλε
αυτή.
Ο
1ος
tor
server
βλέπει
την
ip
της
alice
αλλά
όχι
τα
δεδομένα
που
στέλνει
(διότι
έχουν
κρυπτογραφηθεί
με
τα
δημ.
Κλειδιά
και
των
τριών
nodes).
Επίσης
δεν
βλέπει
τον
τελικό
αποδέκτη
του
μηνύματος.
Ο
2ος
tor
server
δεν
ξέρει
ούτε
την
ip
της
alice
ούτε
τα
δεδομένα
που
στέλνει.
o
3ος
(tor
exit)
βλέπει
το
μήνυμα
που
έστειλε
η
alice
στον
bob,
αλλά
δεν
μπορεί
να
συνδέσει
το
μήνυμα
αυτό
με
την
alice.
Μάθημα
1ο
Κ.Α.Δραζιώτης
19
Στο
πρώτο
βήμα
της
επικοινωνίας
της
alice
με
τον
bob
η
alice
με
χρήση
του
tor,
φτιάχνει
ένα
δίκτυο
(circuit)
όπου
με
κάθε
proxy
server
εκτελείται
ένα
πρωτόκολλο
ανταλλαγής
κλειδιού,
όπου
στο
τέλος
η
alice
καταλήγει
να
έχει
τρία
δημόσια
κλειδιά
(onion
public
keys
t1,t2,t3).
Μάθημα
1ο
Κ.Α.Δραζιώτης
20
et1
(
s1
)
alice
(res.,
h
(
s1
))
1st
relay
es1
(
n
2
,
et2
(
s
2
))
Μάθημα
1ο
Κ.Α.Δραζιώτης
21
relay
1
4.et2
(
s
2
)
7.es1
(
es2
(
et3
(
s3
),
n3
),
n
2
)
5.(resp.,
h
(
s
2
))
alice
relay
2
Μάθημα
1ο
Κ.Α.Δραζιώτης
22
Μάθημα
1ο
Κ.Α.Δραζιώτης
24
Μάθημα
1ο
Κ.Α.Δραζιώτης
25
Μάθημα
1ο
Κ.Α.Δραζιώτης
26
the
reports
describe
"major
problems"
following
users
across
the
tor
network
no
decrypt
available
for
this
pgp
encrypted
message
this
file
is
licensed
under
the
creative
commons
attribution
3.0
unported
license.
attribution:
laura
poitras
/
praxis
films
source
:
http://www.theverge.com/2014/12/2
8/7458159/encryption-standardsthe-nsa-cant-crack-pgp-tor-otrsnowden
(13/2/2014)
https://citizenfourfilm.com/
Μάθημα
1ο
Κ.Α.Δραζιώτης
27
ssh-protocol
Αντικατέστησε
το
telnet.
Χρησιμοποιει
κρυπτογραφία
δημοσίου
κλειδιού.
Για
να
πετύχει
την
αυθεντικοποίηση
μεταξύ
client-server.
kατόπιν
χρησιμοποιεί
συμμετρικη
κρυπτογραφία
(blowfish,
aes)
για
κρυπτογράφηση
δεδομένων.
h
βασική
του
χρήση
είναι
να
έχω
ασφαλη
απομακρυσμένη
σύνδεση
στην
γραμμή-εντολών
σε
unixtype
systems.
Η
αυθεντικοποίηση
γίνεται
με
το
host
key
του
server.
Τη
πρώτη
φορά
που
συνδεόμαστε
μας
ζητάει
ο
server
να
αποδεχτούμε
ένα
κλειδι
και
επίσης
μας
δίνεται
και
το
αποτύπωμα
του
κλειδιού.
Πριν
δεχτούμε
το
κλειδι,
η
σωστή
διαδικασία
είναι
να
επαληθεύσουμε
το
αποτύπωμα
(π.χ.
με
απευθείας
συνομιλία
με
τον
sys-admin
του
server)
Κατόπιν,
κάθε
φορά
που
θα
συνδεόμαστε
θα
γίνεται
αυτόματα
έλεγχος
αν
το
(public)
host
key
είναι
το
σωστό.
Επίσης,
μπορώ
να
χρησιμοποιήσω
ssh-tunneling,
π.χ.
Όταν
θέλει
κάποιος
να
προσπεράσει
ένα
firewall
ή
για
secure
ftp.
Μάθημα
1ο
Κ.Α.Δραζιώτης
28
Ψηφιακό
χρήμα
Το
κανονικό
χρήμα
έχει
δύο
βασικές
ιδιότητες.
1.
Ο
χρήστης
είναι
ανώνυμος
στον
αγοραστή
2.
Εφόσον
το
κατέχει
αυτόματα
έχει
δικαίωμα
να
το
χρησιμοποιεί.
Οι
πιστωτικές
κάρτες
ικανοποιούν
μόνο
την
δεύτερη
ιδιότητα.
Το
ψηφιακό
νόμισμα
bitcoin
βασίζει
την
ασφάλεια
του
στις
ψηφιακές
υπογραφές
Μάθημα
1ο
Κ.Α.Δραζιώτης
29
bitcoin

Αποκεντρωμένο.
Δεν
χρειάζεται
κάποια
κεντρική
αρχή
η
οποία
παρέχει
νομίσματα.
Τα
νομίσματα
παράγονται
εθελοντικά
από
pools,
τα
οποία
καλούνται
να
λύσουν
ένα
μαθηματικό
πρόβλημα
(εύρεση
αντιστροφης
εικόνας
στην
sha256)

Εμεις
για
να
αποκτήσουμε
bitcoins
είτε
συμμετέχουμε
σε
pools
είτε
κανουμε
trading
είτε
τα
αγοράζουμε
απο
ανταλλακτήρια.

Μπορούμε
να
στείλουμε
bitcoin
σε
οποιον
θέλουμε
(δινοντας
μια
μικρη
προμηθεια
στο
δίκτυο),
Η
επαλήθευση
της
συναλλαγης
γινεται
σε
περίπου
δεκα
λεπτά.

Όλες
οι
συναλλαγες
κρατουνται
στο
blockchain.

Η
διευθυνση
μας
δεν
είναι
human-meaningful
αλλά
το
δημόσιο
κλειδι
μιας
ψηφιακής
υπογραφής.
Μάθημα
1ο
Κ.Α.Δραζιώτης
30
bitcoin

Δεν
ελέγχεται
από
κάποια
κεντρικη
αρχή.

Στηρίζεται
αποκλειστικά
σε
εθελοντές,
που
τρέχουν
τα
pools
και
παράγουν
bitcoins.

h
τεχνολογία
blockchain
που
βασίζεται
το
bitcoin
έχει
και
άλλες
εφαρμογές.
Μάθημα
1ο
Κ.Α.Δραζιώτης
31
pgp
:
pretty
good
privacy

Είναι
ένα
πρόγραμμα
το
οποίο
υλοποιεί
το
πρωτόκολλο
open
pgp.
Φτιάχτηκε
αρχικά
από
τον
προγραμματιστή
–
ακτιβιστή
phil
zimmermann.
Στόχος
του
να
μπορεί
οποιοσδήποτε,
να
στέλνει
ηλεκτρονικά
μηνύματα
(e-mails)
με
ασφάλεια.
Σήμερα
χρησιμοποιείται
από
παρα
πολύ
κόσμο
που
απαιτεί
ασφάλεια
στα
e-mail
του.
Όπως
για
παράδειγμα
δημοσιογράφους,
στρατιωτικούς
κλ.π.
Μάθημα
1ο
Κ.Α.Δραζιώτης
32
pgp

Το
pgp
είναι
απαραίτητο
σε
δημοσιογράφους
για
να
μιλούν
με
ασφάλεια
με
τις
πηγές
τους.
Αλλά,
και
για
τους
απλούς
πολίτες
που
θα
επιθυμούσαν
τα
μηνυματα
τους
να
είναι
ασφαλή
από
τα
αδιακριτα
μάτια
των
sys-admins
ή
και
από
“διάφορους”
που
τυχαίνει
να
παρακολουθούν
το
κανάλι
επικοινωνιας
client-mail
server.
Μάθημα
1ο
Κ.Α.Δραζιώτης
33
e-voting
Σε
αυτά
τα
συστήματα
κάθε
ηλεκτρονική
ψήφος
στέλνεται
σε
ένα
κεντρικό
server
(voting
center).
Το
κέντρο
αυτό
καταμετράει
τις
ψήφους
χωρίς
όμως
να
μπορεί
να
αναγνωρίσει
την
ταυτότητα
του
ατόμου
που
ψήφισε.
Μάθημα
1ο
Κ.Α.Δραζιώτης
34
instant
messengers

signal,
silent
phone
Είναι
text
messengers
σε
android.
Ο
δε
πρώτος
υποστηρίζεται
από
τον
'πάπα΄
της
κρυπτογραφίας
bruce
schneier
καθώς
και
τον
e.snowden
και
l.poitras.
Ο
δεύτερος
είναι
του
phil
zimmermann,
τον
προγραμματιστή
του
διάσημου
pgp.
Μάθημα
1ο
Κ.Α.Δραζιώτης
35
zero-knowledge
proofs
Σε
αυτά
τα
συστήματα
κάποιος
έχει
αποδείξει
ένα
θεώρημα.
Θέλει
να
πείσει
ένα
φίλο
του
ότι
ξέρει
την
απόδειξη
του
θεωρήματος,
χωρίς
όμως
να
του
τη
δείξει.
Μάθημα
1ο
Κ.Α.Δραζιώτης
36
post
quantum
crypto
based
in
lattices.
Μάθημα
1ο
Κ.Α.Δραζιώτης
37
Ομομορφική
κρυπτογράφηση
Μάθημα
1ο
Κ.Α.Δραζιώτης
38
Το
πρόβλημα
της
ομομορφικής
κρυπτογράφησης
Στα
ομομορφικά
συστήματα
ο
bob
δεν
γνωρίζει
το
ιδιωτικό
κλειδί
της
alice
(ως
συνήθως)
επίσης
γνωρίζει
κάποια
κρυπτογραφημένα
μηνύματα
c[1],c[2],..,c[k]
και
μία
συνάρτηση
f.
Τότε,
μπορεί
να
υπολογίσει
την
κρυπτογράφηση
του
μηνύματος
f(m[1],m[2],
…,m[k]).
Φορμαλιστικά
θέλουμε
dec(
f
(c1
,
c2
,...,
cn
))

f
(
m1
,
m2
,....,
mk
)
Μάθημα
1ο
Κ.Α.Δραζιώτης
39
cloud
crypto
1o
σεναρίο.
Έστω
ότι
έχετε
έναν
mail-provider
που
χρησιμοποιεί
cloud.
Έστω
επίσης
ότι
όλα
τα
ηλ.μηνύματα
σας
είναι
κρυπτογραφημένα
με
το
δημόσιο
κλειδί
σας.
Έστω
ότι
θέλετε
να
ψάξετε
στα
ηλ.μηνύματα
για
την
λέξη
:
φόρος.
Για
να
το
κάνετε
αυτό
είτε
πρέπει
να
αποκρυπτογραφήσετε
ένα-ένα
τα
μηνυματα
σας
είτε
να
στείλετε
το
ιδιωτικό
κλειδί
σας
στον
παροχέα
για
να
βρείτε
τα
μηνύματα
που
σας
ενδιαφέρουν.
Μάθημα
1ο
Κ.Α.Δραζιώτης
40
cloud
crypto
Μια
λύση
στο
πρόβλημα
θα
ήταν
να
μπορείτε
με
κάποιο
τρόπο
να
κάνετε
κάποιες
πραξεις
στα
κρυπτογραφημένα
μηνύματα
c[i]
που
να
αντιστοιχούν
σε
κάποιες
πράξεις
στα
m[i]
χωρίς
την
χρήση
του
ιδιωτικού
σας
κλειδιού.
Τα
συστήματα
αυτά
ονομάζονται
fully
homomorphic
encryption
systems
(fhe).
Μάθημα
1ο
Κ.Α.Δραζιώτης
41
2o
σενάριο.
h
alice
δουλευει
σε
μια
εταιρεία
που
υλοποιεί
συστήματα
κρυπτογραφίας
ενώ
ο
bob
σε
εταιρεία
cloud.
Πάλι
η
alice
μπορεί
να
στέλνει
κρυπτογραφημένα
μηνύματα
στον
bob
με
pk
crypto
αλλά
επίσης
επιθυμεί
κάποια
μηνύματα
να
μην
μπορεί
να
τα
δει
o
bob.
Δηλαδή
θέλει
να
χρησιμοποιει
τους
διακομιστές
του
bob
να
εκτελούν
κάποιες
εργασίες
στα
δεδομένα
που
στέλνει,
αλλά
o
bob
να
μην
μπορεί
να
δει
τι
κάνει
η
alice.
Μάθημα
1ο
Κ.Α.Δραζιώτης
42
bob’s
cloud
average
f=average
cloud
cloud
ksjljflkjfalj
tasks
kdsadsfsd
κρυπτογράφηση
alice
alice
Μάθημα
1ο
αποκρυπτογραφηση
3.3
(1,4,5)
Οι
servers
του
bob
επεξεργάζονται
Τα
δεδομένα
της
alice
χωρις
να
τα
Βλέπουν.
Εδώ
γίνεται
ο
υπολογισμός
της
f.
kdsadsfsd
ksjljflkjfalj
Στην
κλασικη
pkc
Σ’αυτό
το
σημείο
θα
είχαμε
αποκρυπτογράφηση
Στην
κλασικη
pkc
Σ’αυτό
το
σημείο
θα
είχαμε
κρυπτογράφηση
Κ.Α.Δραζιώτης
43
rivest-shamir
(again)
and
dertouzos!
(https://en.wikipedia.org/wiki/
michael_dertouzos)
Η
πρωτη
ιδέα
της
ομομορφικής
κρυπτογράφησης
ήταν
των
rivest-shamir-derouzos
το
1978.
to
πρώτο
fhe
δόθηκε
το
2009
από
τον
gentry.
to
σύστημα
του
gentry
χρησιμοποιεί
πιθανοτικη
κρυπτογράφηση
εισάγοντας
την
έννοια
του
noise
computation.
Κωδικοποιεί
το
προβλημά
του
σε
lattice.
Σε
κάθε
σημείο
εισάγει
θόρυβο.
Τα
σημεία
που
δημιουργουνται
είναι
το
κρυπτογραφημένο
μήνυμα.
Κατόπιν
γίνονται
οι
πράξεις
επί
των
νέων
σημείων.
Η
αποκρυπτογράφηση
γίνεται
με
φιλτράρισμα
του
θορύβου.
Αν
ο
θόρυβος
ξεπεράσει
ένα
όριο
τότε
η
αποκρυπτογράφηση
επαναλαμβάνεται.
Μάθημα
1ο
Κ.Α.Δραζιώτης
44
lightweight
crypto
Τεχνολογίες
όπως
rfid(passive),
sensors,
coprocesors,
smart
clothes
κ.λ.π.
και
γενικά
όπου
έχω
λίγη
μνήμη
και
υπολογιστική
δύναμη
(συνήθως
την
μετράμε
με
gate-equivalent,
π.χ.
ο
ΑΕs-128
χρειάζεται
3400ge)
είναι
δύσκολο
εώς
αδύνατο
να
υλοποιήσουμε
κρυπτογραφία
συμμετρική
και
ακόμη
πιο
δύσκολα
δημοσίου
κλειδιού.
Τα
rfid
χρησιμοποιούνται
ήδη
ως
ιατρικά
εμφυτευματα,
στα
διαβατήρια,
στις
πιστωτικές,
στα
διόδια,
στα
τραπεζικά
νομίσματα,
σαν
barcodes
κ.α.
Μάθημα
1ο
Κ.Α.Δραζιώτης
45
ge-crypto
primitives
Μερικά
παραδείγματα
κρυπτοσυστημάτων
και
τα
ισοδύναμα
τους
σε
ge
για
να
υλοποιηθούν
σε
επίπεδο
πυλών.
Ένα
rfid
διαθέτει
10000ge
και
για
κρυπτογραφία
είναι
διαθέσιμες
περίπου
3000ge.
Μάθημα
1ο
primitive
g.e.
aes-128
(sym.)
3400
ntrue
(pkey)
2850
des
(sym.)
2309
eec-112
(pkey)
10113
present-80
(sym.)
1075
wipr
(pkey)
5700
sea
(sym.)
449
sha256
10800
trivium
2600
md5
8400
Κ.Α.Δραζιώτης
46
Ερωτήσεις

Εσείς
ως
νέοι
επιστήμονες
της
πληροφορικής
πιστεύετε
ότι
έχετε
τις
απαραίτητες
γνώσεις
να
κατανοήσετε
τους
κινδύνους
στο
διαδίκτυο;

Πως
θα
σχολιάζατε
την
θέση
:
i
have
nothing
to
hide.
Μάθημα
1ο
Κ.Α.Δραζιώτης
47
-
Στοιχεία
από
πιθανότητες
-
Παράδοξο
των
γενεθλίων
-
Τέλεια
ασφάλεια
κατά
shannon
Ας
είναι
u
{0,1}n
ένα
πεπερασμένο
σύνολο.
Ορισμός.
mία
κατανομή
πιθανότητας
είναι
μια
συνάρτηση
p:u[0,1]
τ.ω.

p(
x)
1
xu
Μάθημα
1ο
Κ.Α.Δραζιώτης
48
Για
παράδειγμα
η
ομοιόμορφη
κατανομή
:
`
1
x

u
,
p
(
x)

|u
|
Ενώ
διάνυσμα
της
κατανομής
ονομάζω
π.χ.
για
την
περίπτωση
n=2
το
διάνυσμα
p(0,0),p(1,0),p(0,1),p(1,1)).
Ενδεχόμενο
ονομάζω
κάθε
υποσύνολο
Α
του
u.
Παρατηρήστε
ότι
p(u)=1.
Μάθημα
1ο
Κ.Α.Δραζιώτης
49
Παράδειγμα
Ας
είναι
u
{0,1}4
Βρείτε
την
πιθανότητα
του
ενδεχομένους
Α
που
τα
δύο
τελευταία
λιγότερο
σημαντικά
ψηφία
του
είναι
το
10.
Δηλαδή,
a
{x
u
:
lsb2
(
x)
10}
Υποθέτουμε
ότι
η
επιλογή
των
ψηφίων
γίνεται
με
τυχαίο
τρόπο.
Λύση.
Το
|u|=2^4=16.
Για
τα
δύο
πιο
σημαντικά
ψηφία,
εφόσον
είναι
δυαδικά
ψηφία,
έχουμε
2^2=4
δυνατότητες.
Εφόσον,
η
επιλογή
γίνεται
τυχαία
(ομοιόμορφα)
p(a)=4/16=1/4
Μάθημα
1ο
Κ.Α.Δραζιώτης
50
Ονομάζουμε
τυχαία
μεταβλητή
Χ
μια
συνάρτηση
από
τον
δειγματοχώρο
uv,
όπου
v
ένα
υποσύνολο
του
r.
Δηλ.
Οι
τ.μ.
είναι
πραγματικές
συναρτήσεις,
αλλά
υπάρχουν
και
τ.μ.
που
μπορούν
να
έχουν
τιμές
στο
σύνολο
{Τrue,
false},
σε
πίνακες,
σε
ακολουθίες
κ.λπ.
Παράδειγμα.
Αν
x
:{0,1}n

{0,1}
με
x
(
z
)
lsb(
z
),
δηλαδή
αν
z
101...01,
τότε
1
1
x
(
z
)
1.
Έχουμε
p(
x
1)

,
p(
x
0)

.
2
2
Μάθημα
1ο
Κ.Α.Δραζιώτης
51
Ας
είναι
u
{0,1}.n
Ονομάζουμε
ομοιόμορφη
τ.μ.
r
(και
συμβολίζουμε
),
την
τ.μ.
που
ικανοποιεί
την
p(
r
a
)

1

1
a

u
.
|u
|
2n
Παράδειγμα.
Έστω
με
r1
:
u

{0,1},
με
r1
(abc
)
a
και
r3
:
u

{0,1},
με
r3
(
abc
)
c.
και
x
(
z
)
r1
(
z
)

r3
(
z
).
Τότε
52
Ένωση
και
τομή
ενδεχομένων
Ισχύει
p
(
a

b
)
p
(
a
)

p
(
b
)
Ορισμός.
Λέμε
ότι
τα
ενδεχόμενα
Α,Β,
είναι
ανεξάρτητα
μεταξύ
τους
αν
p(
a

b
)
p(
a
)
p(
b
)
Επίσης
δύο
ενδεχόμενα
ονομάζονται
ξένα
μεταξύ
τους
αν
a

b

Σ’αυτή
την
περίπτωση
ισχύει
p(
a

b
)

p(
a
)

p
(
b
)
Μάθημα
1ο
Κ.Α.Δραζιώτης
53
Δεσμευμένη
πιθανότητα
Αν
γνωρίζουμε
ότι
έχει
συμβεί
κάποιο
γεγονός,
π.χ.
το
Β,
και
θέλουμε
να
υπολογισουμε
την
πιθανότητα
να
συμβεί
ένα
γεγονός
Α,
τότε
μιλάμε
για
δεσμευμένη
πιθανότητα
του
Α
όταν
έχει
συμβεί
το
Β
και
γράφουμε
p(a|b)
Κ.Α.Δραζιώτης
3/22/21
Σελ.
54
Ορισμός
1.
aν
τότε
Αν
όλα
τα
αποτελέσματα
είναι
ισοπίθανα
Κ.Α.Δραζιώτης
3/22/21
Σελ.
55
Πρόβλημα
1.
Ρίχνουμε
ένα
αμερόληπτο
κέρμα
τρεις
φορές.
Ποια
είναι
η
πιθανότητα
p(a|b)
όταν
a={οι
κορώνες
είναι
περισσότερες
από
τα
γράμματα}
b={να
έρθει
στην
1η
ρίψη
γράμματα}
Γ={να
έρθει
στην
1η
ρίψη
κορώνα}
Κ.Α.Δραζιώτης
3/22/21
Σελ.
56
Λύση.
Υπολογίζουμε
το
p(b)
=
½
Κατόπιν,
υπολογίζουμε
την
Άρα,
Ενώ,
Κ.Α.Δραζιώτης
3/22/21
Σελ.
57
Κανόνας
του
bayes
Όπου
Α,Β
ενδεχόμενα
με
p(b)
διάφορο
του
μηδενός.
η
πιθανότητα
να
παρατηρηθεί
το
ενδεχόμενο
Α
η
πιθανότητα
να
παρατηρηθεί
το
ενδεχόμενο
b
aυτές
οι
πιθανότητες
ονομάζονται
και
οριακές
πιθανότητες
(marginal
probabilities)
Κ.Α.Δραζιώτης
3/22/21
Σελ.
58
Πιθανοτικοί
Αλγόριθμοι
Ο
ντετερμινιστικός
αλγόριθμος
για
μια
είσοδο
m
δίνει
πάντα
το
ίδιο
αποτέλεσμα.
Ο
πιθανοτικός
αλγόριθμος
Α
εξαρτάται
και
από
μια
τυχαία
μεταβλητή
r.
Είναι
της
μορφής
z
←
a
(
m;r
)
Άρα
ένα
πιθανοτικός
αλγόριθμος
ορίζει
μια
τ.μ.
πάνω
στο
σύνολο
των
αποτελεσμάτων.
Μάθημα
1ο
Κ.Α.Δραζιώτης
59
ΧΟr
(αποκλειστική
διάζευξη)
Ερώτηση
:
αν
τότε
z

z
?
Μάθημα
1ο
n
z

{0,1}
Κ.Α.Δραζιώτης
60
n
u

{0,1}
Θεώρημα.
Αν
Χ
τ.μ.
πάνω
στο
και
Υ
ομοιόμορφη
τ.μ.
πάνω
στο
u
ανεξάρτητη
απ’την
Χ,
τότε
η
τ.μ.
z

x

y
είναι
ομοιόμορφη
τ.μ.
πάνω
στο
u.
Μάθημα
1ο
Κ.Α.Δραζιώτης
61
Απόδειξη.
(για
n=1).
aρκεί
ν.α.ο.
p[
z
0]
1
/
2.
Οι
πίνακες
κατανομής
των
τ.μ.
Χ,Υ,Ζ
είναι
x
p
0
p[0]
1
p[1]
y
p
0
1/2
1
1/2
x
y
p
0
0
p[0]/2
0
1
p[0]/2
1
0
p[1]/2
1
Μάθημα
1ο
1
Κ.Α.Δραζιώτης
p[1]/2
62
Ισχύει
p[
z
0]
p[(
x
,
y
)
(0,
0)
ή
(
x
,
y
)
(1,1)]

p[(
x
,
y
)
(0,
0)]

p[(
x
,
y
)
(1,1)]

p0
p1
p0

p1
1




ο.ε.δ.
2
2
2
2
Μάθημα
1ο
Κ.Α.Δραζιώτης
63
to
παράδοξο
των
γενεθλίων
Θεώρημα.
h
πιθανότητα
δύο
ή
περισσότερα
άτομα,
σε
μια
ομάδα
23
ατόμων,
να
έχουν
ίδια
μέρα
γενέθλια
είναι
μεγαλύτερη
από
50%.
(ισοδύναμη
εκδοχή
του)
Θεώρημα.
Αν
έχω
r1
,
r2
,...,
rn
:
u

r
ανεξάρτητες
τ.μ.
και
n

1.2
|
u
|,
τότε
pr[i

j
:
ri
rj
}
1
/
2.
(θα
το
ξαναθυμηθούμε
στις
συναρτήσεις
κατακερματισμού)
Μάθημα
1ο
Κ.Α.Δραζιώτης
64
Απόδειξη
της
1η
εκδοχής
Έστω
ότι
μία
τάξη
έχει
n
μαθητές
και
ενδιαφερόμαστε
για
την
πιθανότητα
του
ενδεχομένους
Α={δύο
μαθητές
να
έχουν
γενέθλια
την
ίδια
ημέρα}.
Αρκεί
να
υπολογίσουμε
την
πιθανότητα
του
συμπληρωματικού
Α’={όλοι
οι
μαθητές
έχουν
γενέθλια
διαφορετική
ημέρα}.
Τότε
pr(a)=1-pr(a’).
Μάθημα
1ο
Κ.Α.Δραζιώτης
65
Υποθέτουμε
ότι
ο
χρόνος
έχει
365
ημέρες.
Τότε
για
τον
1ο
μαθητή
έχω
365
δυνατότητες
για
τον
2ο,
364
κ.ο.κ.
για
το
j
μαθητή
365-(j-1)=365-j+1.
Οπότε
προκύπτει
Για
n=10,
έχω
1-pr(a’)=0.116…
Για
n=20,
έχω
1-pr(a’)=0.410…
Για
n=23,
έχω
1-pr(a’)=0.507…
Για
n=24,
έχω
1-pr(a’)=0.537…
Μάθημα
1ο
Κ.Α.Δραζιώτης
66
Γενικά,
λοιπόν
αν
έχω
Η
πιθανότητα
να
έχω
μια
διένεξη
με
πιθάνοτητα
τουλάχιστον
p,
όταν
έχω
n
τιμές
κάποιων
x[1],….,x[n]
είναι
Μάθημα
1ο
Κ.Α.Δραζιώτης
68
Αλλά,
(Μετά
από
πράξεις)
προκύπτει
(για
αρκετά
μεγάλο
n)
n

2b
ln(1
/
(1

p
)
)
Μάθημα
1ο
Κ.Α.Δραζιώτης
69
Τι
είναι
κρυπτοσύστημα
(αυστηρός
ορισμός)
Ένα
κρυπτοσύστημα
επί
της
τριάδας
(
k
,
m
,
c
)
Είναι
ένα
ζευγάρι
«αποδοτικών»
αλγορίθμων
(e,d)
και
ένας
αλγόριθμος
gen
που
παράγει
τα
ιδιωτικά
κλειδια,
τέτοιοι
ώστε
e
:
k
m

c
,
d
:
k
c

m
e
(k
,
m)
c,
d(k
,
e
(k
,
m))
m,
(k
,
m)

k
m
e:
είναι
συχνά
πιθανοτικός
αλγόριθμος,
d:
ντετερμινιστικός
αλγόριθμος
Μάθημα
1ο
Κ.Α.Δραζιώτης
70
one
time
pad
Πρώτος
ο
frank
miler
ανακάλυψε
τον
otp.
Επίσης
το
1917
ανακαλύφθηκε
ανεξάρτητα
από
τον
gilbert
vernam
(με
την
πρόσθεση
mod
2).
Η
σωστή
του
χρήση
όμως
δόθηκε
από
τον
joseph
mauborgne
.
Η
λάθος
χρήση
αυτού
του
συστήματος
στο
πρόγραμμα
venona,
επέτρεψε
την
αποκρυπτογράφηση
περίπου
3000
μηνυμάτων
των
σοβιετικών,
την
περίοδο
του
δεύτερου
Παγκοσμίου
Πολέμου.
Μάθημα
1ο
Κ.Α.Δραζιώτης
71
number
stations
Οι
σταθμοί
αριθμών
είναι
ένα
τύπος
ραδιοφωνικών
σταθμών
(shortwave
radio
stations)
που
εκπέμπουν
σε
συχνότητες
μεταξύ
1.3
και
30
mhz
(λίγο
πάνω
από
τα
μεσαία
ΑΜ).
Μπορούν
να
μεταδώσουν
μηνύματα
σε
μεγάλες
αποστάσεις,
επειδή
ανακλώνται
στην
ιονόσφαιρα.
Οι
σταθμοί
αριθμών
χρησιμοποιούν
αυτές
τις
συχνότητες
για
να
στείλουν
κρυπτογραφημένα
μηνύματα
σε
απομακρυσμένους
πράκτορες
κάνοντας
χρήση
του
otp.
[
https://en.wikipedia.org/wiki/numbers_station
]
Μάθημα
1ο
Κ.Α.Δραζιώτης
72
one
time
pad
(otp)
o
otp
αποτελεί
το
μοναδικό
παράδειγμα
ασφαλούς
κρυπτοσυστήματος.
Εδώ
έχουμε
Το
κλειδί
έχει
μήκος
όσο
το
μήκος
του
μηνύματος.
o
αλγόριθμος
gen
επιστρέφει
κλειδιά
μήκους
n,
που
επιλέγονται
ομοιόμορφα
από
το
Μάθημα
1ο
Κ.Α.Δραζιώτης
73
one
time
pad
Για
να
κρυπτογραφήσω
με
τον
ΟΤp
κάνω
xor
το
μήνυμα
με
το
κλειδί
(bit
με
bit).
Επομένως,
e
(
k
,
m
)
c
k

m
eνώ
η
αποκρυπτογράφηση
είναι
d(k
,
c
)
k

c
Ισχύει
d(k,e(k,m))=m;
Μάθημα
1ο
Κ.Α.Δραζιώτης
74
one
time
pad
Ερώτηση.
Αν
γνωρίζουμε
το
μήνυμα
m
και
το
κρυπτομήνυμα
c,
μπορούμε
να
βρούμε
το
κλειδί
k;
Μάθημα
1ο
Κ.Α.Δραζιώτης
75
one
time
pad
Ο
ΟΤp
έχει
πολύ
«γρήγορη»
κρυπτογράφηση
και
αποκρυπτογράφηση.
Παρόλα
αυτά
έχει
μεγάλο
μήκος
κλειδιού
και
αυτό
τον
κάνει
μη
πρακτικό.
Το
ερώτημα
είναι,
αν
είναι
αρκετά
ασφαλής
για
να
τον
χρησιμοποιήσω;
Μάθημα
1ο
Κ.Α.Δραζιώτης
76
one
time
pad
Στο
ερώτημα
αυτό
απάντησε
ο
shannon.
aπόδειξε
το
1946,
ότι
ο
otp
έχει
«τέλεια
ασφάλεια».
Τέλεια
ασφάλεια
σημαίνει
ότι
αν
κάποιος
έχει
το
κρυπτομήνυμα
c,
αυτό
δεν
του
παρέχει
καμιά
πληροφορία
για
το
αρχικό
μήνυμα
m,
και
αυτό
συμβαίνει
για
κάθε
m,c.
Πριν
ασχοληθούμε
με
αυτόν
τον
ορισμό,
πρέπει
να
καταλάβουμε
τι
σημαίνει
να
είναι
ασφαλές
ένα
σύστημα.
Μάθημα
1ο
Κ.Α.Δραζιώτης
77
Τι
σημαίνει
ένα
κρυπτοσύστημα
είναι
ασφαλές;
threat
model
for
encryption
:
ciphertext
only
attack.
Υποθέτουμε
ότι
η
alice
και
o
bob
έχουν
ένα
κοινό
κλειδί
k
που
έχει
παραχθεί
από
τον
αλγόριθμο
gen.
h
alice
στέλνει
το
μήνυμα
c=e(k,m)
και
η
eve
το
κλέβει
μέσα
από
το
κανάλι
επικοινωνίας.
Ασφαλές
θα
μπορούσε
να
ήταν
το
κρυπτοσυστημα
μας
αν
:
1.
είναι
αδύνατον
η
eve
να
μπορεί
να
βρει
το
κλειδί
k;
ή
2.
είναι
αδύνατον
η
eve
να
μπορεί
να
βρει
το
m
από
το
c;
ή
3.
είναι
αδύνατον
η
eve
να
μπορεί
να
βρει
έναν
χαρακτήρα
του
m;
Μάθημα
1ο
Κ.Α.Δραζιώτης
78
Το
1
δεν
είναι
καλός
ορισμός
ασφάλειας.
Για
παράδειγμα
θεωρείστε
το
κρυπτοσύστημα
e(k,m)=m
για
κάθε
m.
Παρότι
είναι
δύσκολο
να
βρεί
η
eve
το
κλειδί,
είναι
πολύ
εύκολο
να
βρει
το
μήνυμα
m.
Το
2
επίσης
δεν
είναι
καλός
ορισμός
ασφάλειας,
αλλά
είναι
καλύτερος
από
τον
ορισμό
1.
Ας
πάρουμε
για
παράδειγμα
ένα
κρυπτοσύστημα
στο
οποίο
η
eve
μπορεί
να
μαθαίνει
το
80%
του
μηνύματος
m.
Σύμφωνα
με
τον
ορισμό
2
αυτό
το
σύστημα
είναι
ασφαλές
(αφου
η
eve
δεν
μαθαίνει
όλο
το
μηνυμα).
Φυσικά
ένα
τέτοιο
σύστημα
δεν
μπορεί
να
θεωρηθεί
ασφαλές.
Επίσης
το
3
δεν
είναι
καλός
ορισμός
ασφάλειας
αλλά
είναι
καλύτερος
από
τον
2.
Ας
θεωρήσουμε
ένα
κρυπτοσύστημα
όπου
η
eve
δεν
μαθαίνει
κανένα
χαρακτήρα
του
μηνύματος
m
αλλα
μπορεί
να
μάθει
άλλες
πληροφορίες
για
το
μήνυμα
m.
Για
παράδειγμα,
αν
η
alice
στέλνει
λεφτά
στον
bob,
π.χ.
1000Ε.
h
Εve
δεν
μπορεί
να
μάθει
το
ποσό,
αλλά
για
παράδειγμα
μπορεί
να
μάθει
ότι
είναι
περισσότερα
από
500Ε.
Ένα
τέτοιο
σύστημα
επίσης
δεν
μπορεί
να
θεωρηθεί
ασφαλές.
Μάθημα
1ο
Κ.Α.Δραζιώτης
79
o
σωστός
ορισμός
:
Ανεξάρτητα
από
την
“προηγούμενη”
γνώση
που
έχει
η
eve
για
το
μήνυμα
m,
η
eve
κλέβοντας
το
κρυπτομήνυμα
c,
δεν
αποκτά
κάποια
επιπλέον
πληροφορία
για
το
μήνυμα
m.
Ο
ορισμός
αυτός
δόθηκε
από
τον
cloude
shannon
το
1945,
στην
εργασία
του
a
mathematical
theory
of
cryptography.
Για
να
εκφράσουμε
μαθηματικά
τον
προηγούμενο
ορισμό
χρειαζόμαστε
την
έννοια
της
δεσμευμένης
πιθανότητας.
Έστω
o
χώρος
μηνυμάτων,
κρυπτογραφημένων
μηνυμάτων
και
κλειδιών
αντίστοιχα
και
(gen,e,d)
οι
αλγόριθμοι
παραγωγής
κλειδιών,
κρυπτογράφησης
και
αποκρυπτογράφησης,
αντίστοιχα.
‘Εστω
-
Κ
η
τυχαία
μεταβλητή
που
δηλώνει
το
κλειδί,
-
Μ
η
τ.μ.
που
δηλώνει
το
μήνυμα
και
-
c
η
τ.μ.
που
δηλώνει
το
κρυπτογραφημένο
μήνυμα.
Για
παράδειγμα,
ο
αλγόριθμος
gen
oρίζει
μια
κατανομή
πιθανότητας
επί
του
συνόλου
Μάθημα
1ο
Κ.Α.Δραζιώτης
80
Μια
λογική
υπόθεση
που
κάνουμε
είναι
η
εξής
:
Οι
τ.μ.
m
και
Κ
είναι
ανεξάρτητες.
Δηλαδή,
το
μήνυμα
που
λαμβάνει
ο
bob,
δεν
εξαρτάται
από
το
κλειδί
που
χρησιμοποιήθηκε
για
την
κρυπτογράφηση
του.
Επομένως
αν
έχουμε
ένα
συγκεκριμένο
κρυπτοσύστημα,
θα
έχουμε
και
την
κατανόμη
της
τ.μ.
Μ
επί
του
χώρου
μηνυμάτων
καθώς
και
την
κατανομή
της
τ.μ.
k
επί
του
χώρου
κλεδιών.
Εκτελoύμε
το
εξής
πείραμα:
1.
Διαλέγουμε
ένα
μήνυμα
m
σύμφωνα
με
την
κατανομή
της
τ.μ.
m
2.
Παράγουμε
ένα
κλειδί
k
σύμφωνα
με
την
κατανομή
της
Κ
3.
Υπολογίζουμε
το
c
=
e(k,m)
aυτό
το
πείραμα
ορίζει
μια
νέα
τ.μ.,
την
ονομάζουμε
c,
επί
του
χώρου
Μάθημα
1ο
Κ.Α.Δραζιώτης
81
tελικά,
ο
ορισμός
της
τέλειας
ασφάλειας
(perfect
security),
μπορεί
να
γραφτεί
ως
εξής
:
1ος
ορισμός
τέλειας
ασφάλειας
Για
oποιαδήποτε
κατανομή
πιθανότητας
που
ακολουθεί
η
τ.μ.
Μ
και
για
κάθε
μήνυμα
m
και
κρυπτογραφημένο
μήνυμα
c
(με
pr[c=c]>0),
ισχύει
a
posteriori
probability
η
πιθανότητα
Μ=m
όταν
γνωρίζουμε
το
κρυπτομήνυμα
c
a
priori
probability
h
πιθανότητα
το
m=m
Δηλ.
η
γνώση
του
c
δεν
παρέχει
κάποια
επιπλέον
πληροφορία
για
το
μήνυμα
m.
Μάθημα
1ο
Κ.Α.Δραζιώτης
82
mια
συνέπεια
του
προηγούμενου
ορισμού
είναι
το
παρακάτω
θεώρημα.
Θεώρημα.
Ικανή
και
αναγκαία
συνθήκη
για
να
έχει
ένα
κρυπτοσύστημα
τέλεια
ασφάλεια
είναι
:
για
όλα
τα
μηνύματα
m
και
κρυπτομηνύματα
c.
Απόδειξη.
Από
τον
ορισμό
1
και
το
θεώρημα
του
bayes
έχουμε,
eφόσον
το
σύστημα
έχει
τέλεια
ασφάλεια
Οπότε
το
ζητούμενο
προκύπτει
άμεσα.
Ο.ε.δ.
Δηλαδή,
η
συνολική
πιθανότητα
των
κλειδιών
που
μετασχηματίζουν
το
μήνυμα
m[0]
στο
c
ισούται
με
την
συνολική
πιθανότητα
των
κλειδιών
που
μετασχηματίζουν
το
m[1]
στο
c
και
αυτό
ισχύει
για
κάθε
m[0],m[1]
και
c.
Μάθημα
1ο
Κ.Α.Δραζιώτης
83
yπάρχει
ένας
ακόμη
ορισμός
της
τέλειας
ασφάλεια
που
δεν
εμπλέκει
α
posteriori
και
a
priori
πιθανότητες.
Ο
προηγούμενος
ορισμό
δόθηκε
από
τον
c.
shannon
το
1946
(αλλά
το
άρθρο
του
δημοσιεύτηκε
το
1949).
2ος
ορισμός
τέλειας
ασφάλειας
Έστω
(e,d,gen.)
ένα
κρυπτοσύστημα
επί
των
συνόλων
.
Λέμε
ότι
το
προηγούμενο
κρυπτοσύστημα
έχει
τέλεια
ασφάλεια
αν-ν
για
κάθε
και
για
κάθε
,
Μάθημα
1ο
Κ.Α.Δραζιώτης
84
Θεώρημα
ισοδυναμίας
Χωρίς
απόδειξη
δίνουμε
το
παρακάτω.
Οι
ορισμοί
1
και
2
είναι
ισοδύναμοι
Για
την
απόδειξη
μπορείτε
να
δείτε
[εδώ]
Μάθημα
1ο
Κ.Α.Δραζιώτης
85

Δηλαδή
αν
η
Εύα
“κλέψει”
το
c,
τότε
δεν
έχει
ιδέα
αν
αυτό
προήλθε
από
το
m[0]
ή
από
το
m[1].
Μάθημα
1ο
Κ.Α.Δραζιώτης
86
tέλεια
ασφάλεια
του
one
time
pad
1ο
Θεώρημα
του
shannon.
Ο
ΟΤp
έχει
τέλεια
ασφάλεια.
Απόδειξη.
Αρκεί
ν.α.ο.
για
κάθε
mє
m
και
cє
c
η
πιθανότητα
p(e(k,m)=c)
(καθώς
το
k
διατρέχει
όλα
τα
κλειδιά
στο
k)
είναι
ανεξάρτητη
από
το
m.
Πράγματι,
τότε
ικανοποιείται
ο
ορισμός
Τ.Α.
του
shannon.
Μάθημα
1ο
Κ.Α.Δραζιώτης
87
#{k

k
:
e
(k
,
m)
c}
Ισχύει
p[
e
(
k
,
m)
c]
=
.
#k
Αλλά
#{k

k
:
e
(
k
,
m)
c}
1.
Πράγματι
η
εξίσωση
k

m
c,
έχει
μοναδική
λύση
ως
προς
k,
την
k
m

c.
1
Άρα
p[
e
(k
,
m)
c]

n
(σταθερά
ανέξαρτητη
από
το
m).
2
Μάθημα
1ο
Κ.Α.Δραζιώτης
88
Οne
time
pad
Παρόλα
αυτά
ο
otp
δεν
χρησιμοποιείται
στην
πράξη.
Υπενθυμίζουμε
ότι
η
βασική
αδυναμία
του
otp
είναι
ότι
τα
κλειδιά
πρέπει
να
έχουν
μήκος
όσο
το
μήκος
του
μηνύματος.
Ερώτηση.
Μήπως
υπάρχουν
κρυπτοσυστήματα
που
έχουν
Τ.Α.
αλλά
μικρά
κλειδιά;
Μάθημα
1ο
Κ.Α.Δραζιώτης
89
Οne
time
pad
2ο
Θεώρημα
(shannon).
Αν
ένα
κρυπτοσύστημα
έχει
Τ.Α.
τότε
μήκος
του
κλειδιού≥μήκος
του
μηνύματος
Πως
μπορούμε
να
κάνουμε
πρακτικό
τον
ΟΤp;
Θα
πρέπει
να
εισάγουμε
τις
γεννήτριες
ψευδοτυχαίων
αριθμών
(prg).
Τα
νέα
συστήματα
που
θα
προκύψουν
θα
τα
ονομάσουμε
κρυπτοσυστήματα
ροής.
Μάθημα
1ο
Κ.Α.Δραζιώτης
90
Σημασιολογικά
Ασφαλές
κρυπτοσύστημα
Ένας
πιο
ρεαλιστικός
ορισμός
ασφάλειας
είναι
η
σημασιολογική
ασφάλεια
(ss-semantic
security).
Θα
μπορούσαμε
να
ονμάσουμε
αυτό
το
επίπεδο
ασφάλειας
:
πρακτικά
τέλεια
ασφάλεια.
Η
διαφόρα
με
την
τέλεια
ασφάλεια
είναι
ότι
εδώ
η
eve
έχει
“πολυωνυμική
δύναμη”.
Θυμηθείτε
ότι
στον
ορισμό
της
τέλειας
ασφάλειας,
δεν
έγινει
κάποια
υπόθεση
για
τις
δυνατότητες
της
eve.
Στον
ορισμό
της
σημασιολογικής
ασφάλειας
υποθέτουμε
ότι
η
eve
έχει
στην
κατόχη
της
πολυωνυμική
υπολογιστική
δυνατότητα
και
\
όχι
“άπειρη”
όπως
στον
ορισμό
της
τέλειας
ασφάλειας.
Μάθημα
1ο
Κ.Α.Δραζιώτης
91
h
ιδέα
της
σημασιολογικής
ασφάλειας
δόθηκε
πρώτη
φόρα
από
την
shafi
goldwasser
και
τον
silvio
micali,
το
1984,
στηνν
εργασία
τους
probabilistic
encryption
&
how
to
play
mental
poker
keeping
secret
all
partial
information.
Σε
αυτή
την
εργασία
εκτός
του
ορισμού
της
σημασιολογικής
ασφάλειας,
δίνεται
και
ο
ορισμός
της
“partial
information”.
eπίσης
δίνεται
έμφαση
στην
χρήση
της
πιθανοτικής
κρυπτογράφησης
έναντι
της
ντετερμενιστικής.
aς
δούμε
πως
όρισαν
την
έννοια
της
“μερικής
πληροφορίας”.
Ορισμός.
Έστω
μια
αποδοτική
συνάρτηση.
Αν
η
eve
γνωρίζει
το
c=e(k,m)
και
μπορεί
να
υπολογίσει
το
f(m),
λέμε
ότι
τότε
έχει
μια
μερική
πληροφορία
για
το
m.
Όπως
έχουμε
ήδη
δει,
επί
του
χώρου
μηνυμάτων
υπάρχει
μια
κατανομή
p.
yποθέτουμε
ότι
η
πιθανότητα
η
συνάρτηση
f
να
πάρει
την
τιμή
1(true)
είναι
p>0.5
ως
προς
την
κατανομή
p.
oρισμός.
h
eve
έχει
πλεονέκτημα
ε>0
στον
υπολογισμό
της
συνάρτησης
f,
αν
η
πιθανότητα
pr{f(m)=1,
όταν
γνωρίζει
το
c}>p+ε.
Ορισμός
(σημασιολογική
ασφάλεια).
Αν
η
eve
δεν
έχει
πλεονέκτημα
ε,
λέμε
ότι
το
σύστημα
είναι
σημασιολογικά
ασφαλές.
92
Για
να
αποδείξουμε
ότι
ένα
κρυπτοσυστήμα
δεν
είναι
σημασιολογικά
ασφαλές,
αρκεί
να
βρούμε
μια
f
(την
συναρτηση
αυτή
την
λέμε
και
predicate)
επί
του
χώρου
μηνυμάτων,
ώστε
να
μπορεί
να
υπολογιστεί
με
“μεγάλη”
πιθανότητα
η
πιθανότητα
του
ενδεχομένους
{f(m)=1}
επί
ενός
(τυχαίου)
μηνύματος
m
εάν
έχουμε
το
κρυπτογραφημένο
μήνυμα
c
του
m.
Ας
θεωρήσουμε
το
κρυπτοσύστημα
του
Καίσαρα.
Αν
αριθμήσουμε
το
αλφάβητο
{α,β,γ,…,ω}
με
τους
αριθμούς
0,1,2,…,23,
αντίστοιχα,
τότε
η
συνάρτηση
κρυπτογράφησης
είναι
e(m)=(m+3)
mod
24
(με
κλειδί
k=3).
Υποθέτουμε
ότι
ό
χώρος
μηνυμάτων’(και
κρυπτογραφημένων
μηνυμάτων)
είναι
όλες
οι
λέξεις
με
5
χαρακτήρες,
και
το
σύνολο
των
κλειδιών
{0,1,…,23}.
Π.χ.
e(αυριο)=Ε(0-20-16-8-14)=(3-23-19-11-17)=δψφμσ
Θεωρούμε
την
predicate
f,
το
μήνυμα
m
έχει
δύο
ίδιους
χαρακτήρες.
Τότε
με
πιθάνοτητα
ένα
μπορούμε
να
υπολογίσουμε
την
f
επί
οποιουδήποτε
μηνύματος
m,
αρκεί
να
έχουμε
την
κρυπτογράφηση
του
c.
Πράγματι,
αν
στο
c
υπάρχουν
δύο
ίδιοι
χαρακτήρες
τότε
αναγκαστικά
στο
m
υπάρχουν
δύο
ίδιοι
χαρακτήρες
(ανεξάρτητα
της
επιλογής
του
κλειδιού.).
93
Υπάρχει
και
ένας
δεύτερος
ορισμός
που
βασίζεται
στα
παίγνια.
Αυτός
ο
ορισμός
είναι
ισοδύναμος
με
τον
αρχικό
ορισμό
της
σημασιολογικής
ασφάλειας
όπως
δόθηκε
προηγουμένος.
Ο
ορισμός
αυτός,
όπως
και
στην
περίπτωση
του
(δεύτερου)
ορισμού
της
τέλειας
ασφάλειας
βασίζεται
στην
ικανότητα
της
eve
να
μπορεί
να
διαχωρίσει
δύο
μηνύματα
ίδιου
μήκους.
94
2ος
Ορισμός
Σημασιολογικής
Ασφάλειας
(για
Συμμετρικά
κρυπτοσυστήματα)
attack
game
between
alice
and
eve
alice
eve
2.m[0],m[1]
(len(m[0])=len(m[1])
1.k
←k
(random)
3.b
←
{0,1}
(random)
efficient
algorithm
a
4.c=e(k,m[b])
to
παίγνιο
ορίζεται
ως
εξής
1.
h
alice
διαλέγει
ένα
τυχαίο
κλειδί.
2.
Η
eve
στέλνει
δύο
μηνύματα
m[0],
m[1]
===
[challenge]
===
3.
h
alice
διαλέγει
στην
τύχη
ένα
bit
b.
4.
Η
Αlice
κρυπτογραφεί
το
μήνυμα
m[b].
Έστω
c=e(k,m[b])
και
το
στέλνει
στην
eve.
5.
Η
eve
εξάγει
b'=0
ή
1.
5.
b'=0
ή
1
Η
eve
κερδίζει
το
παιχνίδη
αν
βρει
ποιο
μήνυμα
κρυπτογράφησε
η
alice,
με
πιθανότητα
>1/2.
95
Επίσης
ορίζουμε
τα
εξής
πειράματα
με
την
βοήθεια
του
προηγούμενου
Παίγνιου.
Λέμε
ότι
εκτελέστηκε
το
πείραμα
exp(0)
αν
η
alice
κρυπτογράφησε
το
m[0],
διαφορετικά
λέμε
ότι
εκτέλεσε
το
πείραμα
exp(1).
Επίσης
με
w[b]
γράφουμε
το
ενδεχόμενο
w[b]={Α(exp(b))=1},
όπου
Α
ο
αλγόριθμος
της
eve.
to
ενδεχόμενο
αυτό
έχει
νόημα
μόνο
για
την
Εve
και
όχι
για
την
alice,
διότι
για
την
alice
είναι
το
βέβαιο
ενδεχόμενο,
pr(alice,w[b])
=
1.
h
pr(eve,w[b]),
εξαρτάται
από
τον
αλγόριθμο
Α.
Μάθημα
1ο
Κ.Α.Δραζιώτης
96
Τέλος,
δίνουμε
και
τον
ορισμό
της
συνάρτησης
πλεονεκτήματος
(advantage
function).
Ορισμός.
Ο
αποδοτικός
αλγόριθμος
που
χρησιμοποιεί
η
eve.
Μάθημα
1ο
Το
κρυπτοσύστημα
μας
Κ.Α.Δραζιώτης
97
Ορισμός
σημασιολογικής
ασφάλειας.
Το
κρυπτοσύστημα
ονομάζεται
σημασιολογικά
ασφαλές
αν
για
κάθε
αποδοτικό
αλγόριθμο
Α
η
συνάρτηση
είναι
αμελητέα.
Μάθημα
1ο
Κ.Α.Δραζιώτης
98
Παρατηρήσεις
επί
του
ορισμού
1.
Όταν
η
συνάρτηση
πλεονεκτήματος
είναι
κοντά
στο
1,
τότε
το
συστημα
δεν
είναι
ss,
διότι
η
eve
μπορεί
να
ξεχωρίσει
ποιο
πείραμα
εκτελέστηκε.
2.
Όταν
είναι
κοντά
στο
0,
το
σύστημα
είναι
semantically
secure.
Μάθημα
1ο
Κ.Α.Δραζιώτης
99
Άσκηση
Αν
η
eve
μπορεί
να
εξάγει
το
λιγότερο
σημάντικο
bit
του
αρχικού
μηνύματος,
από
ένα
κρυπτογραφημένο
μήνυμα,
τότε
το
σύστημα
δεν
είναι
σημασιολογικά
ασφαλές.
Γιατί;
(να
εξηγηθεί
με
τον
ορισμό
2,
διότι
με
τον
ορισμό
1
είναι
προφανές
ότι
δεν
είναι
ss).
Μάθημα
1ο
Κ.Α.Δραζιώτης
100
Είναι
το
ΟΤp
ss;
alice
2.m[0],m[1]
(len(m[0])=len(m[1])
1.k
←k
(random)
3.b
←
{0,1}
(random)
eve
efficient
algorithm
a
4.c=e(k,m[b])=c
xor
m[b]
Ίδιες
κατανομές
(ομοιόμορφες),
διότι
το
κλειδί
k
είναι
τυχαίο,
οπότε
από
την
ιδιότητα
της
xor,
οι
κατανομές
είναι
ομοιόμορφες.
homework
1
[να
παραδοθούν
μέχρι
20/3,
στο
elearning]
1.
Έστω
το
eλληνικό
αλφάβητο
{α,β,γ,…,ω}.
Δίνουμε
διαδοχικά
τιμές
α:0,β:1,…,ω:24.
to
κρυπτοσύστημα
μετατόπισης
π.χ.
με
κλειδί
k=3,
ορίζεται
e(k,α)=(0+3)mod
24
=
3→δ.
Δηλ.
Αν
το
κλειδί
είναι
k
με
0<=k<=23,
τότε
Ε(k,x)=(αριθμητική
τιμή
του
x
+
k)mod
24,
ενώ
η
αποκρυπτογράφηση
d(k,y)=(αριθμητική
τιμή
του
y
-
k)mod
24
Αν
έχουμε
να
κρυπτογραφήσουμε
μια
λέξη
εφαρμόζουμε
την
κρυπτογράφηση
σε
κάθε
γράμμα
ξεχωριστά.
(i)
Έστω
ότι
έχουμε
την
παρακάτω
κατανομή
επί
του
χώρου
μηνυμάτων
pr[m=’α’]=0.7,
pr[m=’ω’]=0.3.
Να
υπολογιστεί
η
πιθανότητα
pr[c=’β’].
yπενθυμίζουμε
ότι
οι
τ.μ.
m,k
(Μ
είναι
η
κατανομή
επι
του
χώρου
μηνυμάτων
και
Κ
η
κατανομή
επί
του
χώρου
κλειδιών
είναι
ανεξάρτητες).
(ii)
Έστω
ότι
έχουμε
την
παρακάτω
κατανομή
επί
του
χώρου
μηνυμάτων
pr[m=’ενα’]=0.3,
pr[m=’δυο’]=0.7.
Να
υπολογιστεί
η
πιθανότητα
pr[c=’θπδ’].
homework
2
[να
παραδοθούν
μέχρι
28/3,
στο
elearning]
1.
Άσκηση
3.1
(από
τις
σημειώσεις
)
2.
Υπο
ποιες
προυποθέσεις
θα
μπορούσε
το
σύστημα
του
Καίσαρα
να
έχει
τέλεια
ασφάλεια
;
3.
Έχουμε
το
εξής
σύστημα.
Το
σύνολο
μηνυμάτων
και
κρυπτογραφημένων
μηνυμάτων
είναι
{0,1,2,…,100}.
to
σύνολο
των
κλειδιών
είναι
οι
(περιττοί)
πρώτοι
αριθμοί
μικρότεροι
του
100.
Η
συνάρτηση
κρυπτογράφησης
είναι
όπου
p
το
κλειδί
(δηλ.
ένας
περιττός
πρώτος
<100).
Να
εξετάσετε
αν
το
σύστημα
έχει
σημασιολογική
ασφάλεια.
(
Π.χ.
αν
θέλουμε
να
κρυπτογραφήσουμε
το
μήνυμα
m
=100
με
κλεδί
31,
έχουμε
c=18.
aποδεικνύεται
ότι
αν
κάποιος
έχει
το
c
και
τον
πρώτο
αριθμό
p,
μπορεί
να
βρεί
το
m
(
tonelli
algorithm
)
σε
πολυωνυμικό
χρόνο.).
Υπόδειξη.
Σκεφτείται
μια
predicate
που
μπορείτε
εύκολα
να
βρείτε
μια
ιδιότητα
του
m
αν
γνωρίζετε
το
c
(αλλά
αυτο
να
μπορείτε
να
το
κάνετε
για
κάθε
ζευγαρι
(m,c)
).

